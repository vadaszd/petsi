<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="304.2px" preserveAspectRatio="none" style="width:940px;height:304px;" version="1.1" viewBox="0 0 940 304" width="940.2px" zoomAndPan="magnify"><defs><filter height="300%" id="f276rw89op86k" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="1.2"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="2.4" dy="2.4" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="10.8" lengthAdjust="spacingAndGlyphs" textLength="145.2" x="394.95" y="16.0248">Pop token from input place</text><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="52.9812" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="97.5" y="193.3842"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="8.4" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="177.9" y="225.3654"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="201.1248" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="376.8" y="66.2406"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="78.8718" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="459.6" y="175.8936"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="34.2906" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="614.7" y="83.7312"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="8.4" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="799.5" y="101.2218"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="8.4" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="886.8" y="135.5124"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="106.653" style="stroke: #000000; stroke-width: 1.2;" width="453.3" x="63" y="152.9124"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="36.1812" style="stroke: #000000; stroke-width: 1.2;" width="221.4" x="69" y="202.3842"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="29.4" x2="29.4" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="100.2" x2="100.2" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="180.6" x2="180.6" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="251.4" x2="251.4" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="312.3" x2="312.3" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="379.5" x2="379.5" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="462.3" x2="462.3" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="543.9" x2="543.9" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="617.7" x2="617.7" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="802.5" x2="802.5" y1="46.35" y2="278.1654"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 5.0,5.0;" x1="889.5" x2="889.5" y1="46.35" y2="278.1654"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="29.4" x="13.8" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="21" x="18" y="37.1689">Alice</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="29.4" x="13.8" y="277.5654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="21" x="18" y="289.5625">Alice</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="48.6" x="75" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="40.2" x="79.2" y="37.1689">transition</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="48.6" x="75" y="277.5654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="40.2" x="79.2" y="289.5625">transition</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="93" x="134.4" y="22.7719"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="93" x="132" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="84.6" x="136.2" y="37.1689">transition observers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="93" x="134.4" y="277.5654"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="93" x="132" y="279.9654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="84.6" x="136.2" y="291.9625">transition observers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="26.4" x="238.2" y="22.7719"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="26.4" x="235.8" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="18" x="240" y="37.1689">arcs</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="26.4" x="238.2" y="277.5654"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="26.4" x="235.8" y="279.9654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="18" x="240" y="291.9625">arcs</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="61.8" x="280.5" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="53.4" x="284.7" y="37.1689">output place</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="61.8" x="280.5" y="277.5654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="53.4" x="284.7" y="289.5625">output place</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="55.8" x="350.7" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="47.4" x="354.9" y="37.1689">input place</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="55.8" x="350.7" y="277.5654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="47.4" x="354.9" y="289.5625">input place</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="90.6" x="417.3" y="22.7719"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="90.6" x="414.9" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="82.2" x="419.1" y="37.1689">PresenceObservers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="90.6" x="417.3" y="277.5654"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="90.6" x="414.9" y="279.9654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="82.2" x="419.1" y="291.9625">PresenceObservers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="50.4" x="518.7" y="22.7719"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="50.4" x="516.3" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="42" x="520.5" y="37.1689">observers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="50.4" x="518.7" y="277.5654"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="50.4" x="516.3" y="279.9654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="42" x="520.5" y="291.9625">observers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="34.8" x="599.1" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="26.4" x="603.3" y="37.1689">Token</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="34.8" x="599.1" y="277.5654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="26.4" x="603.3" y="289.5625">Token</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.8" x="764.1" y="22.7719"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.8" x="761.7" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="68.4" x="765.9" y="37.1689">token observers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.8" x="764.1" y="277.5654"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.8" x="761.7" y="279.9654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="68.4" x="765.9" y="291.9625">token observers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.2" x="851.7" y="22.7719"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.2" x="849.3" y="25.1719"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="67.8" x="853.5" y="37.1689">place observers</text><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.2" x="851.7" y="277.5654"/><rect fill="#FEFECE" filter="url(#f276rw89op86k)" height="18.1781" style="stroke: #A80036; stroke-width: 0.8999999999999999;" width="76.2" x="849.3" y="279.9654"/><text fill="#000000" font-family="sans-serif" font-size="8.4" lengthAdjust="spacingAndGlyphs" textLength="67.8" x="853.5" y="291.9625">place observers</text><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="52.9812" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="97.5" y="193.3842"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="8.4" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="177.9" y="225.3654"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="201.1248" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="376.8" y="66.2406"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="78.8718" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="459.6" y="175.8936"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="34.2906" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="614.7" y="83.7312"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="8.4" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="799.5" y="101.2218"/><rect fill="#FFFFFF" filter="url(#f276rw89op86k)" height="8.4" style="stroke: #A80036; stroke-width: 0.6;" width="6" x="886.8" y="135.5124"/><line style="stroke: #000000; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="1.8" x2="933.3" y1="52.95" y2="52.95"/><polygon fill="#A80036" points="369.6,63.8406,375.6,66.2406,369.6,68.6406,372,66.2406" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6;" x1="251.4" x2="373.2" y1="66.2406" y2="66.2406"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="54" x="255.6" y="63.1988">token = pop()</text><polygon fill="#A80036" points="607.5,81.3312,613.5,83.7312,607.5,86.1312,609.9,83.7312" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6;" x1="382.8" x2="611.1" y1="83.7312" y2="83.7312"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="76.8" x="387" y="80.6894">removeFrom(place)</text><polygon fill="#A80036" points="792.3,98.8218,798.3,101.2218,792.3,103.6218,794.7,101.2218" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6;" x1="620.7" x2="795.9" y1="101.2218" y2="101.2218"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="109.2" x="624.9" y="98.18">reportDepartureFrom(place)</text><polygon fill="#A80036" points="627.3,107.2218,621.3,109.6218,627.3,112.0218,624.9,109.6218" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="623.7" x2="801.9" y1="109.6218" y2="109.6218"/><polygon fill="#A80036" points="389.4,115.6218,383.4,118.0218,389.4,120.4218,387,118.0218" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="385.8" x2="617.1" y1="118.0218" y2="118.0218"/><polygon fill="#A80036" points="879.6,133.1124,885.6,135.5124,879.6,137.9124,882,135.5124" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6;" x1="382.8" x2="883.2" y1="135.5124" y2="135.5124"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="99.6" x="387" y="132.4706">reportDepartureOf(token)</text><polygon fill="#A80036" points="389.4,141.5124,383.4,143.9124,389.4,146.3124,387,143.9124" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="385.8" x2="889.2" y1="143.9124" y2="143.9124"/><path d="M63,152.9124 L101.4,152.9124 L101.4,157.1124 L95.4,163.1124 L63,163.1124 L63,152.9124 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6;"/><rect fill="none" height="106.653" style="stroke: #000000; stroke-width: 1.2;" width="453.3" x="63" y="152.9124"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4" x="72" y="160.7612">alt</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="97.8" x="110.4" y="160.2474">[Place has become empty]</text><polygon fill="#A80036" points="452.4,173.4936,458.4,175.8936,452.4,178.2936,454.8,175.8936" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6;" x1="382.8" x2="456" y1="175.8936" y2="175.8936"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="64.2" x="387" y="172.8518">reportNoToken()</text><polygon fill="#A80036" points="110.1,190.9842,104.1,193.3842,110.1,195.7842,107.7,193.3842" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6;" x1="106.5" x2="459" y1="193.3842" y2="193.3842"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="115.2" x="113.7" y="190.3424">incrementDisabledArcCount()</text><path d="M69,202.3842 L107.4,202.3842 L107.4,206.5842 L101.4,212.5842 L69,212.5842 L69,202.3842 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 0.6;"/><rect fill="none" height="36.1812" style="stroke: #000000; stroke-width: 1.2;" width="221.4" x="69" y="202.3842"/><text fill="#000000" font-family="sans-serif" font-size="7.8" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="11.4" x="78" y="210.233">alt</text><text fill="#000000" font-family="sans-serif" font-size="6.6" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="171" x="116.4" y="209.7192">[before incrementing disabledArcCount == 0]</text><polygon fill="#A80036" points="170.7,222.9654,176.7,225.3654,170.7,227.7654,173.1,225.3654" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6;" x1="103.5" x2="174.3" y1="225.3654" y2="225.3654"/><text fill="#000000" font-family="sans-serif" font-size="7.8" lengthAdjust="spacingAndGlyphs" textLength="52.8" x="107.7" y="222.3236">gotDisabled()</text><polygon fill="#A80036" points="110.1,231.3654,104.1,233.7654,110.1,236.1654,107.7,233.7654" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="106.5" x2="180.3" y1="233.7654" y2="233.7654"/><polygon fill="#A80036" points="452.4,243.9654,458.4,246.3654,452.4,248.7654,454.8,246.3654" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="100.5" x2="456" y1="246.3654" y2="246.3654"/><polygon fill="#A80036" points="389.4,252.3654,383.4,254.7654,389.4,257.1654,387,254.7654" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="385.8" x2="462" y1="254.7654" y2="254.7654"/><polygon fill="#A80036" points="258,264.9654,252,267.3654,258,269.7654,255.6,267.3654" style="stroke: #A80036; stroke-width: 0.6;"/><line style="stroke: #A80036; stroke-width: 0.6; stroke-dasharray: 2.0,2.0;" x1="254.4" x2="379.2" y1="267.3654" y2="267.3654"/><!--MD5=[d0270b47696211c47f82727c23497f1c]
@startuml

title Transition firing

participant Alice order 10
participant transition order 20
collections "transition observers" order 25
collections arcs order 30
participant "output place" order 33
participant "input place" order 35
collections observers order 40
collections PresenceObservers order 38
participant Token order 45
collections "token observers" order 50
collections "place observers" order 60

Alice -> transition: fire()
activate transition

transition -> transition : isEnabled()

alt true

transition -> "transition observers": beforeFiring()
activate "transition observers"
return

transition -> arcs: flow()
activate arcs

alt constructor arc
arcs -> Token**++: token = new(type)

Token -> observers++: observe(token)
observers -> "token observers"**
return

Token -> Token: attachObserver()

Token -> "token observers"++: reportConstruction()
return

|||
ref over arcs, "output place", Token, "token observers"
push token to output place
end ref
|||

else transfer arc
|||
ref over arcs, "output place", Token, "token observers"
pop token from input place
end ref
|||
ref over arcs, "output place", Token, "token observers"
push token to output place
end ref
|||

else destructor arc
|||
ref over arcs, "output place", Token, "token observers"
pop token from input place
end ref
|||
arcs -> Token: delete()
activate Token
Token -> "token observers"++: reportDestruction()
destroy "token observers"
return
Token -> Token: removeObserver(AbstractTokenObserver o)

destroy Token
return
else test arc
note over arcs: Nothing to do
end

return

transition -> "transition observers": afterFiring()
activate "transition observers"
return

transition - -> Alice: normal return

else false

transition - -> Alice: exception

end

deactivate

newpage Push token to output place

arcs -> "output place"++: push(token)

"output place" -> Token++: moveTo(place)

Token -> "token observers"++: reportArrivalAt(place)
return

return

"output place" -> "place observers"++: reportArrivalOf(token)
return

alt Place was previously empty
"output place" -> PresenceObservers++ : reportSomeToken()

PresenceObservers -> transition++: decrementDisabledArcCount()
alt after decrementing disabledArcCount == 0
transition -> "transition observers"++: gotEnabled()
return
end
return
return
end

return

newpage Pop token from input place

arcs -> "input place"++: token = pop()

"input place" -> Token++: removeFrom(place)

Token -> "token observers"++: reportDepartureFrom(place)
return

return

"input place" -> "place observers"++: reportDepartureOf(token)
return

alt Place has become empty
"input place" -> PresenceObservers++ : reportNoToken()

PresenceObservers -> transition++: incrementDisabledArcCount()
alt before incrementing disabledArcCount == 0
transition -> "transition observers"++: gotDisabled()
return
end
return
return
end

return
@enduml

PlantUML version 1.2020.09(Sun May 10 12:51:06 CEST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 11.0.7+10-b765.53
Operating System: Linux
Default Encoding: UTF-8
Language: hu
Country: HU
--></g></svg>